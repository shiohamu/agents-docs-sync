# ステップ8: GitHub Actionsでの動作確認

## 目的

GitHub上でワークフローが正常に動作することを確認します。

## 作業内容

### 1. 変更をコミット・プッシュ

```bash
git add .
git commit -m "feat: add CI/CD pipeline for tests, docs, and AGENTS.md"
git push
```

### 2. GitHubのActionsタブで確認

GitHubリポジトリの「Actions」タブを開き、以下を確認：

**確認項目**:
- [ ] ワークフローが起動するか
- [ ] 各ジョブが正常に完了するか
- [ ] エラーがないか確認

**期待される動作**:
- プッシュ後、数秒以内にワークフローが起動する
- `test`ジョブが最初に実行される
- `test`ジョブが成功した後、`generate-docs`ジョブが実行される
- 両方のジョブが緑色（成功）で表示される

### 3. 生成されたドキュメントの確認

**確認項目**:
- [ ] AGENTS.mdが更新されているか
- [ ] README.mdが更新されているか
- [ ] docs/api.mdが更新されているか

**確認方法**:
1. リポジトリのファイル一覧で、これらのファイルの最終更新日時を確認
2. 自動コミットが実行された場合、コミット履歴に`docs: auto-update documentation [skip ci]`というコミットが追加されている

## トラブルシューティング

### ワークフローが起動しない

1. YAMLの構文エラーがないか確認
2. ブランチ名が正しいか確認（main/master/develop）
3. ワークフローファイルのパスが正しいか確認（`.github/workflows/`）

### テストジョブが失敗する

1. テスト環境が正しくセットアップされているか確認
2. 依存関係がインストールされているか確認
3. テストファイルに構文エラーがないか確認
4. GitHub Actionsのログを確認してエラーメッセージを確認

### ドキュメント生成ジョブが失敗する

1. Pythonのバージョンが正しいか確認（3.12）
2. 必要なパッケージ（pyyaml）がインストールされているか確認
3. `.docgen/docgen.py`が正しく実行できるか確認
4. GitHub Actionsのログを確認してエラーメッセージを確認

### 自動コミットが機能しない

1. `GITHUB_TOKEN`の権限を確認
   - リポジトリの設定 → Actions → General → Workflow permissions
   - "Read and write permissions"が有効になっているか確認
2. ワークフローの`if`条件が正しいか確認
   - `github.event_name == 'push'`が条件に含まれているか
3. 変更されたファイルが正しくステージングされているか確認
   - `git add docs/ README.md AGENTS.md`が実行されているか
4. ブランチ保護ルールが自動コミットをブロックしていないか確認

## 確認事項

- [ ] ワークフローが正常に実行されるか
- [ ] 自動コミットが機能するか（設定した場合）
- [ ] エラーログがないか
- [ ] 生成されたドキュメントが正しいか

## 完了

すべてのステップが完了し、確認事項がすべてクリアされれば、CI/CD統合パイプラインの実装は完了です。

## 次のステップ（オプション）

実装が完了したら、以下の拡張を検討できます：

1. **カバレッジレポートの追加**
   - `pytest-cov`を使用してカバレッジレポートを生成
   - GitHub Actionsでカバレッジを表示

2. **通知機能の追加**
   - テスト失敗時にSlackやメールで通知
   - ドキュメント更新時に通知

3. **マルチブランチ対応**
   - 特定のブランチでのみドキュメントを自動コミット
   - プルリクエスト時の動作をカスタマイズ

4. **パフォーマンス最適化**
   - 並列実行の最適化
   - キャッシュの活用

