# 汎用ドキュメント自動生成システム 設定ファイル
# このファイルを編集して、ドキュメント生成の動作をカスタマイズできます

# 言語設定
languages:
  # 自動検出を有効にするかどうか
  auto_detect: true

  # 優先する言語（自動検出で複数の言語が検出された場合の優先順位）
  # 空の場合は検出された順序を使用
  preferred: []

  # 例:
  # preferred:
  #   - python
  #   - javascript
  #   - go

# 出力設定
output:
  # APIドキュメントの出力パス（プロジェクトルートからの相対パス）
  api_doc: docs/api.md

  # READMEファイルのパス（プロジェクトルートからの相対パス）
  readme: README.md

  # AGENTS.mdの出力パス（プロジェクトルートからの相対パス）
  agents_doc: AGENTS.md

# 生成設定
generation:
  # READMEを更新するかどうか
  update_readme: true

  # APIドキュメントを生成するかどうか
  generate_api_doc: true

  # AGENTS.mdを生成するかどうか
  generate_agents_doc: true

  # 生成モード (template, llm, hybrid)
  # template: テンプレートのみ使用（新しいセクションはLLM生成しない）
  # llm: LLMのみ使用
  # hybrid: テンプレートをベースにLLMで不足部分を補完（推奨）
  agents_mode: hybrid
  readme_mode: hybrid

  # 既存READMEの手動セクションを保持するかどうか
  # <!-- MANUAL_START:section_name --> と <!-- MANUAL_END:section_name --> で
  # 囲まれたセクションは保持されます
  preserve_manual_sections: true

  # Outlinesを使用した構造化出力（実験的機能）
  # trueに設定すると、LLM出力をJSON Schemaで制約し、より構造化されたドキュメントを生成します
  use_outlines: false

  # Outlinesスキーマファイルのパス（オプション）
  # 指定しない場合はデフォルトのスキーマを使用
  # outlines_schemas:
  #   agents: schemas/agents_schema.json
  #   readme: schemas/readme_schema.json

# キャッシュ設定（オプション）
cache:
  # キャッシュを有効にするかどうか（デフォルト: true）
  # キャッシュを使用することで、変更されていないファイルの再解析をスキップし、
  # ドキュメント生成のパフォーマンスを向上させます
  enabled: true

# AGENTS.md生成設定
agents:
  # LLM使用パターン（'api', 'local', 'both'）
  llm_mode: 'both'

  # LLM生成モード設定
  generation:
    # AGENTS.md生成モード: 'template', 'llm', 'hybrid'
    # - 'template': テンプレートベース生成（デフォルト、高速）
    # - 'llm': LLM完全生成（高品質、時間がかかる）
    # - 'hybrid': テンプレートとLLMを組み合わせ（バランス型）
    agents_mode: 'template'

    # README.md生成モード: 'template', 'llm', 'hybrid'
    readme_mode: 'hybrid'

    # コミットメッセージ自動生成: true/false
    enable_commit_message: true

  # API使用時の設定
  api:
    provider: 'openai'  # 'openai', 'anthropic', 'custom'
    model: 'gpt-4o'  # 使用するモデル名
    endpoint: null  # カスタムエンドポイント（オプション）
    api_key_env: 'OPENAI_API_KEY'  # 環境変数名
    timeout: 180  # タイムアウト（秒）
    max_retries: 3  # 最大リトライ回数
    retry_delay: 1.0  # リトライ間隔（秒）

  # ローカルLLM使用時の設定
  local:
    provider: 'ollama'  # 'ollama', 'lmstudio', 'custom'
    model: 'llama3'  # デフォルトモデル名
    base_url: 'http://localhost:11434'  # デフォルトURL
    timeout: 180  # タイムアウト（秒）
    max_retries: 3  # 最大リトライ回数
    retry_delay: 1.0  # リトライ間隔（秒）

  # コーディング規約の設定
  coding_standards:
    auto_detect: true
    # 手動で指定する場合（auto_detect: false の場合）
    # style_guide: 'PEP 8'
    # formatter: 'black'
    # linter: 'ruff'

  # プロジェクト固有の指示（オプション）
  custom_instructions: null
  # 例:
  # custom_instructions: |
  #   - すべての関数にはdocstringを記述すること
  #   - テストカバレッジは80%以上を維持すること

# RAG設定（実験的機能）
# RAG (Retrieval-Augmented Generation) を使用すると、コードベースから関連情報を抽出し、
# より正確で根拠のあるドキュメントを生成できます。
rag:
  # RAG機能を有効化（デフォルト: true）
  # CLIフラグ --use-rag でも有効化可能
  enabled: true

  # APIドキュメント生成後にベクトルDBを自動生成するかどうか（デフォルト: true）
  # trueに設定すると、agents_docs_syncコマンド実行時にapi.md生成後、
  # 自動的にベクトルインデックスを構築します
  auto_build_index: true

  # 埋め込みモデル設定
  embedding:
    # 使用する埋め込みモデル（sentence-transformersモデル名）
    # 推奨: 'all-MiniLM-L6-v2' (軽量・高速、384次元)
    # その他オプション: 'all-mpnet-base-v2' (高精度、768次元)
    model: 'all-MiniLM-L6-v2'

    # 計算デバイス ('cpu' or 'cuda')
    # CUDAが利用可能な場合はGPUを使用して高速化
    device: 'cpu'

  # ベクトルインデックス設定
  index:
    # インデックスタイプ ('hnswlib' or 'faiss')
    # hnswlib: 軽量・高速、差分更新が一部制限
    # faiss: 高機能だがやや重い
    type: 'hnswlib'

    # HNSW構築時のパラメータ（精度とメモリのトレードオフ）
    ef_construction: 200  # 構築時の探索範囲（大きいほど精度向上、遅くなる）
    M: 16                 # グラフの接続数（大きいほど精度向上、メモリ増加）

  # 検索設定
  retrieval:
    # 取得する類似チャンク数
    top_k: 6

    # スコア閾値（この値以下のチャンクは除外）
    # 0.0-1.0の範囲、低いほど厳格
    score_threshold: 0.3

  # チャンク設定
  chunking:
    # チャンクの最大サイズ（トークン数）
    max_chunk_size: 512

    # チャンク間のオーバーラップ（トークン数）
    # コンテキストの連続性を保つために使用
    overlap: 50

  # 除外パターン（機密情報保護）
  # これらのパターンに一致するファイルはRAGインデックスに含めない
  exclude_patterns:
    - '.*\.env$'
    - 'secrets/.*'
    - '.*_SECRET.*'
    - '.*API_KEY.*'
    - '.*\.old$'

  # 除外ファイル名リスト
  # これらのファイル名に一致するファイルはRAGインデックスに含めない
  # デフォルトで生成されたドキュメントファイルを除外
  exclude_files:
    - 'README.md'
    - 'AGENTS.md'
  #  - 'API.md'


# カスタマイズ設定（オプション）
# custom:
#   # APIドキュメントのテンプレート（将来の拡張用）
#   # api_template: null
#
#   # READMEのテンプレート（将来の拡張用）
#   # readme_template: null

# 除外設定（オプション）
exclude:
  # 除外するディレクトリ
  directories:
    - .venv
    - venv
    - .git
    - __pycache__
    - node_modules
    - htmlcov
    - coverage
    - .coverage
    - site-packages
    - dist
    - build
    - .next
    - .nuxt
    - target
    - bin
    - obj
    - .gradle
    - .idea
    - .vscode
    - .DS_Store
    - .pytest_cache
    - .mypy_cache
    - .tox
    - docgen
    - .tests
    - tests
    - .test
    - test
    - __tests__
    - __test__
    - .old

  # 除外するファイルパターン（glob形式）
  patterns:
    - "*.pyc"
    - "*.pyo"
    - "*.log"
