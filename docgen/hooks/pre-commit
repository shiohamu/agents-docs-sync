#!/bin/bash
#
# pre-commitフック (Orchestrated by docgen)
#

PROJECT_ROOT="$(git rev-parse --show-toplevel 2>/dev/null)"
if [ -z "$PROJECT_ROOT" ]; then
    exit 0
fi

cd "$PROJECT_ROOT" || exit 0

# Pythonコマンド検出
if command -v uv &>/dev/null; then
    PYTHON_CMD="uv run python3"
elif command -v python3 &>/dev/null; then
    PYTHON_CMD="python3"
else
    echo "Warning: python3 not found, skipping pre-commit hook"
    exit 0
fi

# オーケストレーターを実行
exec $PYTHON_CMD -m docgen.hooks.orchestrator pre-commit
